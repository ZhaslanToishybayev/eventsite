<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –≤–∏–¥–∂–µ—Ç–∞</title>
    <link rel="stylesheet" href="/static/css/ai-chat-widget-v2.css?v=2.4.6">
</head>
<body>
    <div style="padding: 50px; font-family: Arial, sans-serif;">
        <h1>üîç –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç AI –≤–∏–¥–∂–µ—Ç–∞</h1>
        <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–∂–µ—Ç–∞</p>

        <button onclick="testWidget()" style="background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 10px;">
            üß™ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–¥–∂–µ—Ç —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å
        </button>

        <div id="test-results" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; font-family: monospace; white-space: pre-wrap;"></div>
    </div>

    <script src="/static/js/ai-chat-widget-v2.js?v=2.4.6"></script>

    <script>
        function updateResults(message) {
            const results = document.getElementById('test-results');
            results.textContent += new Date().toLocaleTimeString() + ': ' + message + '\n';
        }

        function testWidget() {
            updateResults('=== –ù–ê–ß–ê–õ–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø ===');

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏
            updateResults('1. AIChatWidgetV2 –∫–ª–∞—Å—Å: ' + (typeof AIChatWidgetV2));
            updateResults('2. initAIChatWidgetV2 —Ñ—É–Ω–∫—Ü–∏—è: ' + (typeof initAIChatWidgetV2));
            updateResults('3. window.aiChatWidgetV2: ' + (typeof window.aiChatWidgetV2));

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º DOM —ç–ª–µ–º–µ–Ω—Ç—ã
            updateResults('4. –≠–ª–µ–º–µ–Ω—Ç #ai-chat-widget: ' + !!document.getElementById('ai-chat-widget'));
            updateResults('5. –ö–Ω–æ–ø–∫–∞ #chatToggleBtn: ' + !!document.getElementById('chatToggleBtn'));

            // –ü—Ä–æ–±—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
            try {
                if (typeof initAIChatWidgetV2 === 'function') {
                    updateResults('6. –ó–∞–ø—É—Å–∫–∞–µ–º initAIChatWidgetV2()...');
                    const widget = initAIChatWidgetV2();
                    updateResults('7. –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ' + (widget ? 'SUCCESS' : 'NULL'));

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                    setTimeout(() => {
                        updateResults('8. –≠–ª–µ–º–µ–Ω—Ç #ai-chat-widget –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ' + !!document.getElementById('ai-chat-widget'));
                        updateResults('9. –ö–Ω–æ–ø–∫–∞ #chatToggleBtn –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ' + !!document.getElementById('chatToggleBtn'));

                        // –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å –≤–∏–¥–∂–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
                        if (window.aiChatWidgetV2 && typeof window.aiChatWidgetV2.openChat === 'function') {
                            updateResults('10. –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å –≤–∏–¥–∂–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ...');
                            window.aiChatWidgetV2.openChat();
                            updateResults('11. –í–∏–¥–∂–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç');
                        } else {
                            updateResults('10. –ú–µ—Ç–æ–¥ openChat –Ω–µ –Ω–∞–π–¥–µ–Ω');
                        }
                    }, 1000);
                } else {
                    updateResults('6. –û–®–ò–ë–ö–ê: initAIChatWidgetV2 –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π');
                }
            } catch (error) {
                updateResults('6. –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: ' + error.message);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(testWidget, 2000);

        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –æ—à–∏–±–∫–∏
        window.addEventListener('error', function(e) {
            updateResults('–û–®–ò–ë–ö–ê JavaScript: ' + e.message + ' –≤ ' + e.filename + ':' + e.lineno);
        });
    </script>
</body>
</html>