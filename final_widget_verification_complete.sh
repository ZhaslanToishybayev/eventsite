#!/bin/bash

# üöÄ FINAL WIDGET VERIFICATION

echo "üöÄ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –í–ò–î–ñ–ï–¢–ê"
echo "==============================="
echo ""

echo "1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–Ω–æ–ø–æ–∫:"
button_count=$(curl -s http://localhost:8000/ | grep -c "chatToggleBtn")
echo "   –ù–∞–π–¥–µ–Ω–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π chatToggleBtn: $button_count"

if [ "$button_count" -eq 2 ]; then
    echo "   ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–æ: 1 HTML –∫–Ω–æ–ø–∫–∞ + 1 JS –ª–æ–≥"
else
    echo "   ‚ö†Ô∏è  –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ: $button_count —É–ø–æ–º–∏–Ω–∞–Ω–∏–π"
fi

echo ""
echo "2. –ü—Ä–æ–≤–µ—Ä–∫–∞ HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:"
html_content=$(curl -s http://localhost:8000/)

if echo "$html_content" | grep -q "AI Chat Widget Button - Fixed Position"; then
    echo "   ‚úÖ –ö–Ω–æ–ø–∫–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏"
else
    echo "   ‚ùå –ö–Ω–æ–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
fi

if echo "$html_content" | grep -q "ai-chat-trigger-button"; then
    echo "   ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π CSS –∫–ª–∞—Å—Å"
else
    echo "   ‚ùå CSS –∫–ª–∞—Å—Å –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

if echo "$html_content" | grep -q "fas fa-comments"; then
    echo "   ‚úÖ FontAwesome –∏–∫–æ–Ω–∫–∞"
else
    echo "   ‚ùå FontAwesome –∏–∫–æ–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
fi

echo ""
echo "3. –ü—Ä–æ–≤–µ—Ä–∫–∞ CSS:"
css_content=$(curl -s http://localhost:8000/static/css/ai-chat-widget-v2.css)

if echo "$css_content" | grep -q "#chatToggleBtn"; then
    echo "   ‚úÖ CSS —Å—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏"
else
    echo "   ‚ùå CSS —Å—Ç–∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
fi

if echo "$css_content" | grep -q "#6366f1.*#a855f7"; then
    echo "   ‚úÖ –°–∏–Ω–µ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç"
else
    echo "   ‚ùå –ì—Ä–∞–¥–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

echo ""
echo "üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –í–ï–†–î–ò–ö–¢:"
echo "========================"

if [ "$button_count" -eq 2 ] && \
   echo "$html_content" | grep -q "AI Chat Widget Button - Fixed Position" && \
   echo "$css_content" | grep -q "#6366f1.*#a855f7"; then

    echo "üéâ –ü–†–û–ë–õ–ï–ú–ê –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–ê!"
    echo ""
    echo "‚úÖ –¢–µ–ø–µ—Ä—å –Ω–∞ —Å–∞–π—Ç–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¢–û–õ–¨–ö–û –û–î–ò–ù –≤–∏–¥–∂–µ—Ç"
    echo "‚úÖ –û–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–∏–Ω–µ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º"
    echo "‚úÖ –° –∏–∫–æ–Ω–∫–æ–π üí¨ (fa-comments)"
    echo "‚úÖ –ë–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤"
    echo ""
    echo "üöÄ –ü–†–û–í–ï–†–¨–¢–ï –ù–ê –°–ê–ô–¢–ï:"
    echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:8000"
    echo "2. –ù–∞–π–¥–∏—Ç–µ –≤–∏–¥–∂–µ—Ç –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É"
    echo "3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω –æ–¥–∏–Ω"
    echo "4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —á–∞—Ç)"
    echo ""
    echo "üí° –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —á–µ—Ä–Ω—ã–π –∏–ª–∏ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π:"
    echo "   - –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+F5)"
    echo "   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏"

else
    echo "‚ö†Ô∏è  –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞"
    echo "   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã—à–µ –∏ —Å–æ–æ–±—â–∏—Ç–µ –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö"
fi