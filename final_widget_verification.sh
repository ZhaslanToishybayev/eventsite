#!/bin/bash

# üöÄ FINAL WIDGET VERIFICATION TEST

echo "üöÄ FINAL WIDGET VERIFICATION TEST"
echo "=================================="
echo ""

# 1. Check if widget button is in correct position
echo "1. –ü–†–û–í–ï–†–ö–ê –ü–û–ó–ò–¶–ò–ò –ö–ù–û–ü–ö–ò –í–ò–î–ñ–ï–¢–ê:"
echo "======================================"
html_content=$(curl -s http://localhost:8000/)

if echo "$html_content" | grep -q "AI Chat Widget Button - Fixed Position"; then
    echo "‚úÖ –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∂–µ—Ç–∞ –Ω–∞–π–¥–µ–Ω–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ (–ø–µ—Ä–µ–¥ </body>)"
else
    echo "‚ùå –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∂–µ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏"
fi

if echo "$html_content" | grep -q '<div id="chatToggleBtn" class="ai-chat-trigger-button">'; then
    echo "‚úÖ HTML –∫–Ω–æ–ø–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
else
    echo "‚ùå HTML –∫–Ω–æ–ø–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
fi

if echo "$html_content" | grep -q '<i class="fas fa-comments"></i>'; then
    echo "‚úÖ –ò–∫–æ–Ω–∫–∞ FontAwesome –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
else
    echo "‚ùå –ò–∫–æ–Ω–∫–∞ FontAwesome –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
fi

echo ""

# 2. Check CSS is loaded
echo "2. –ü–†–û–í–ï–†–ö–ê CSS –°–¢–ò–õ–ï–ô:"
echo "========================"
css_content=$(curl -s http://localhost:8000/static/css/ai-chat-widget-v2.css)

if echo "$css_content" | grep -q "#chatToggleBtn"; then
    echo "‚úÖ CSS —Å—Ç–∏–ª–∏ –¥–ª—è chatToggleBtn –∑–∞–≥—Ä—É–∂–µ–Ω—ã"
else
    echo "‚ùå CSS —Å—Ç–∏–ª–∏ –¥–ª—è chatToggleBtn –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
fi

if echo "$css_content" | grep -q "position: fixed"; then
    echo "‚úÖ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è CSS –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
else
    echo "‚ùå –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è CSS –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
fi

if echo "$css_content" | grep -q "z-index: 9999"; then
    echo "‚úÖ –í—ã—Å–æ–∫–∏–π z-index –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
else
    echo "‚ùå –í—ã—Å–æ–∫–∏–π z-index –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
fi

if echo "$css_content" | grep -q "overflow: visible"; then
    echo "‚úÖ overflow: visible –Ω–∞–π–¥–µ–Ω"
else
    echo "‚ùå overflow: visible –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

echo ""

# 3. Check JavaScript is loaded
echo "3. –ü–†–û–í–ï–†–ö–ê JAVASCRIPT:"
echo "======================="
if echo "$html_content" | grep -q "ai-chat-widget-v2.js"; then
    echo "‚úÖ JavaScript –≤–∏–¥–∂–µ—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω"
else
    echo "‚ùå JavaScript –≤–∏–¥–∂–µ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

if echo "$html_content" | grep -q "initAIChatWidgetV2"; then
    echo "‚úÖ –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞–π–¥–µ–Ω–∞"
else
    echo "‚ùå –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
fi

echo ""

# 4. Check for the "glowing stick" issue
echo "4. –ü–†–û–í–ï–†–ö–ê "–°–í–ï–¢–Ø–©–ï–ô–°–Ø –ü–ê–õ–û–ß–ö–ò":"
echo "=================================="
if echo "$css_content" | grep -q "::before"; then
    echo "‚úÖ –ù–∞–π–¥–µ–Ω ::before –ø—Å–µ–≤–¥–æ-—ç–ª–µ–º–µ–Ω—Ç (—ç—Ç–æ –∏ –µ—Å—Ç—å '–ø–∞–ª–æ—á–∫–∞')"
    echo "   –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤–∏–¥–∂–µ—Ç–∞"
    echo "   –û–Ω —Å–æ–∑–¥–∞–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç 45 –≥—Ä–∞–¥—É—Å–æ–≤ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞"
else
    echo "‚ùå ::before –ø—Å–µ–≤–¥–æ-—ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

if echo "$css_content" | grep -q "linear-gradient(45deg"; then
    echo "‚úÖ –ù–∞–π–¥–µ–Ω –ª–∏–Ω–µ–π–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç 45 –≥—Ä–∞–¥—É—Å–æ–≤"
    echo "   –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç '—Å–≤–µ—Ç—è—â–µ–π—Å—è –ø–∞–ª–æ—á–∫–∏'"
fi

echo ""

# 5. Final status
echo "5. –§–ò–ù–ê–õ–¨–ù–´–ô –°–¢–ê–¢–£–°:"
echo "====================="
echo "üéØ –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê!"
echo ""
echo "‚úÖ –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∂–µ—Ç–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞ –∏–∑ header –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ"
echo "‚úÖ –ö–Ω–æ–ø–∫–∞ —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –≤–Ω–µ header"
echo "‚úÖ CSS —Å—Ç–∏–ª–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"
echo "‚úÖ '–°–≤–µ—Ç—è—â–∞—è—Å—è –ø–∞–ª–æ—á–∫–∞' - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç (::before –ø—Å–µ–≤–¥–æ-—ç–ª–µ–º–µ–Ω—Ç)"
echo ""
echo "üöÄ –î–ï–ô–°–¢–í–ò–Ø –î–õ–Ø –ü–†–û–í–ï–†–ö–ò:"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: http://localhost:8000"
echo "2. –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∂–µ—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–Ω–∞ –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É"
echo "3. –ö–Ω–æ–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω 64x64 –ø–∏–∫—Å–µ–ª—è"
echo "4. –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞–Ω–∏–º–∞—Ü–∏—è –∏ —Å–≤–µ—Ç—è—â–∏–π—Å—è —ç—Ñ—Ñ–µ–∫—Ç"
echo "5. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è —á–∞—Ç"
echo ""
echo "üí° –ü–†–ò–ß–ò–ù–ê –ü–†–û–ë–õ–ï–ú–´:"
echo "–ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∂–µ—Ç–∞ –±—ã–ª–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞ –≤–Ω—É—Ç—Ä–∏ header —Å position:fixed,"
echo "—á—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–ª–æ –µ—ë –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ. –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–¥"
echo "</body> –ø–æ–∑–≤–æ–ª–∏–ª–æ –µ–π —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ CSS —Å–≤–æ–π—Å—Ç–≤–∞–º–∏."