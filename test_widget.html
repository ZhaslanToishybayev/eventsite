<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç AI –í–∏–¥–∂–µ—Ç–∞</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-form {
            margin-bottom: 30px;
        }
        textarea {
            width: 100%;
            height: 200px;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            font-family: monospace;
            font-size: 14px;
            margin-bottom: 10px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }
        .club-info {
            background: #e8f5e8;
            border-left-color: #28a745;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîß –¢–µ—Å—Ç AI –í–∏–¥–∂–µ—Ç–∞</h1>
        <p>–í–≤–µ–¥–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –∫–∞–∫ –≤–∏–¥–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ:</p>

        <div class="test-form">
            <textarea id="testMessage" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª—É–±–∞: –¢–µ—Å—Ç–æ–≤—ã–π AI –ö–ª—É–± –ü—Ä–æ–±–Ω—ã–π

–û–ø–∏—Å–∞–Ω–∏–µ –∫–ª—É–±–∞ (200+ —Å–∏–º–≤–æ–ª–æ–≤): –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª—É–± –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã AI —Å–∏—Å—Ç–µ–º—ã. –ú—ã —Ç–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª—É–±–æ–≤ —á–µ—Ä–µ–∑ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞. –ö–ª—É–± –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ—Ö, –∫—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º–∏. –ú—ã –ø—Ä–æ–≤–æ–¥–∏–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏, —Å–µ–º–∏–Ω–∞—Ä—ã –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ –æ–±–ª–∞—Å—Ç–∏ AI –∏ machine learning. –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞—à–µ–º—É –ø–µ—Ä–µ–¥–æ–≤–æ–º—É —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º—É —Å–æ–æ–±—â–µ—Å—Ç–≤—É –∏ –±—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç—Ä–µ–Ω–¥–æ–≤!

–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

–ì–æ—Ä–æ–¥: –ê–ª–º–∞—Ç—ã

Email –∫–ª—É–±–∞: test.ai@gmail.com</textarea>
            <button onclick="testWidget()">üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ –≤–∏–¥–∂–µ—Ç</button>
            <button onclick="testDirect()">üîó –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é</button>
        </div>

        <div id="result" class="result">
            <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
            <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...</p>
        </div>
    </div>

    <script>
        async function testWidget() {
            const message = document.getElementById('testMessage').value;
            const resultDiv = document.getElementById('result');

            resultDiv.innerHTML = '<p>üöÄ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–∏–¥–∂–µ—Ç...</p>';

            try {
                const response = await fetch('/api/v1/ai/simplified/interactive/chat/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: message,
                        user_email: 'test@fan-club.kz',
                        state_id: null
                    })
                });

                const json = await response.json();
                displayResult(json, 'widget');
            } catch (e) {
                displayResult({error: e.message}, 'widget');
            }
        }

        async function testDirect() {
            const message = document.getElementById('testMessage').value;
            const resultDiv = document.getElementById('result');

            resultDiv.innerHTML = '<p>üîó –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞–ø—Ä—è–º—É—é...</p>';

            try {
                const response = await fetch('/api/v1/ai/simplified/interactive/chat/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: message,
                        user_email: 'test@fan-club.kz',
                        state_id: null
                    })
                });

                const json = await response.json();
                displayResult(json, 'direct');
            } catch (e) {
                displayResult({error: e.message}, 'direct');
            }
        }

        function displayResult(json, method) {
            const resultDiv = document.getElementById('result');
            let content = '<h3>–†–µ–∑—É–ª—å—Ç–∞—Ç ' + (method === 'widget' ? '—á–µ—Ä–µ–∑ –≤–∏–¥–∂–µ—Ç' : '–ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞') + ':</h3>';

            if (json.message) {
                content += '<div class="club-info">';
                content += '<strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong><br>';
                content += formatMessage(json.message);
                content += '</div>';

                if (json.state_id) {
                    content += '<p><strong>ID —Å–æ—Å—Ç–æ—è–Ω–∏—è:</strong> ' + json.state_id + '</p>';
                }
            } else if (json.error) {
                content += '<p style="color: red;"><strong>–û—à–∏–±–∫–∞:</strong> ' + json.error + '</p>';
            } else {
                content += '<p><strong>–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:</strong></p>';
                content += '<pre>' + JSON.stringify(json, null, 2) + '</pre>';
            }

            resultDiv.innerHTML = content;
        }

        function formatMessage(message) {
            if (typeof message === 'string') {
                return message.replace(/\n/g, '<br>');
            } else if (Array.isArray(message)) {
                return '<strong>–≠—Ç–æ –º–∞—Å—Å–∏–≤ (—É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª—É–±–∞):</strong><br>' + JSON.stringify(message, null, 2);
            } else if (typeof message === 'object') {
                return '<strong>–≠—Ç–æ –æ–±—ä–µ–∫—Ç:</strong><br>' + JSON.stringify(message, null, 2);
            }
            return String(message);
        }
    </script>
</body>
</html>
