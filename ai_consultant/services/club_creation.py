import json
from typing import List, Dict, Optional
from django.contrib.auth import get_user_model
from django.core.exceptions import ValidationError

User = get_user_model()
from clubs.models import Club, ClubCategory, City


class ClubCreationService:
    """
    –°–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–º–æ—â–∏ –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª—É–±–æ–≤
    """

    def __init__(self):
        self.club_templates = self._get_club_templates()
        self.name_generators = self._get_name_generators()
        self.description_templates = self._get_description_templates()

    def _get_club_templates(self) -> Dict[str, Dict]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —à–∞–±–ª–æ–Ω—ã –∫–ª—É–±–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π"""
        return {
            'technology': {
                'name': 'TechHub {}',
                'description': '–°–æ–æ–±—â–µ—Å—Ç–≤–æ IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —ç–Ω—Ç—É–∑–∏–∞—Å—Ç–æ–≤ –≤ {}. –ú—ã –æ–±—ä–µ–¥–∏–Ω—è–µ–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤ –¥–ª—è –æ–±–º–µ–Ω–∞ –æ–ø—ã—Ç–æ–º, –æ–±—É—á–µ–Ω–∏—è –∏ —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.',
                'keywords': ['IT', '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', '—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞', 'digital'],
                'target_audience': '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏, —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã, –¥–∏–∑–∞–π–Ω–µ—Ä—ã, QA-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã',
                'activities': '–í—Å—Ç—Ä–µ—á–∏ —Å —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏, –º–∏—Ç–∞–ø—ã, —Ö–∞–∫–∞—Ç–æ–Ω—ã, –≤–µ–±–∏–Ω–∞—Ä—ã, –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π',
                'skills': ['–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', '–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞', 'DevOps', 'UI/UX', 'Data Science']
            },
            'business': {
                'name': 'Business Connect {}',
                'description': '–°–æ–æ–±—â–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π –∏ –±–∏–∑–Ω–µ—Å-—ç–∫—Å–ø–µ—Ä—Ç–æ–≤ {}. –ú—ã —Å–æ–∑–¥–∞–µ–º —Å—Ä–µ–¥—É –¥–ª—è –æ–±–º–µ–Ω–∞ –æ–ø—ã—Ç–æ–º, –ø–æ–∏—Å–∫–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –∏ —Ä–∞–∑–≤–∏—Ç–∏—è –±–∏–∑–Ω–µ—Å–∞.',
                'keywords': ['–±–∏–∑–Ω–µ—Å', '–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ', '—Å—Ç–∞—Ä—Ç–∞–ø', '–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏', '–º–∞—Ä–∫–µ—Ç–∏–Ω–≥', '–ø—Ä–æ–¥–∞–∂–∏'],
                'target_audience': '–û—Å–Ω–æ–≤–∞—Ç–µ–ª–∏ –∫–æ–º–ø–∞–Ω–∏–π, –º–µ–Ω–µ–¥–∂–µ—Ä—ã, –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥–∏, –∏–Ω–≤–µ—Å—Ç–æ—Ä—ã',
                'activities': '–ë–∏–∑–Ω–µ—Å-–∑–∞–≤—Ç—Ä–∞–∫–∏, –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã, –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥, –ø–∏–Ω—á-—Å–µ—Å—Å–∏–∏, –æ–±–º–µ–Ω –æ–ø—ã—Ç–æ–º',
                'skills': ['–ë–∏–∑–Ω–µ—Å-–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', '–ü—Ä–æ–¥–∞–∂–∏', '–§–∏–Ω–∞–Ω—Å—ã', '–õ–∏–¥–µ—Ä—Å—Ç–≤–æ']
            },
            'creative': {
                'name': 'Creative Space {}',
                'description': '–¢–≤–æ—Ä—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ {}. –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤, –¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤, —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–æ–≤ –∏ –≤—Å–µ—Ö, –∫—Ç–æ –ª—é–±–∏—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫—Ä–∞—Å–æ—Ç—É.',
                'keywords': ['—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ', '–∏—Å–∫—É—Å—Å—Ç–≤–æ', '–¥–∏–∑–∞–π–Ω', '—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è', '—Ç–∞–Ω—Ü—ã', '–º—É–∑—ã–∫–∞'],
                'target_audience': '–•—É–¥–æ–∂–Ω–∏–∫–∏, –¥–∏–∑–∞–π–Ω–µ—Ä—ã, —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ã, –º—É–∑—ã–∫–∞–Ω—Ç—ã, —Ç–∞–Ω—Ü–æ—Ä—ã, —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ –ª—é–¥–∏',
                'activities': '–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã, –≤—ã—Å—Ç–∞–≤–∫–∏, —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ –≤–µ—á–µ—Ä–∞, —Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã, –∞—Ä—Ç-—Ä–µ–∑–∏–¥–µ–Ω—Ü–∏–∏',
                'skills': ['–†–∏—Å–æ–≤–∞–Ω–∏–µ', '–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è', '–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω', '–ú—É–∑—ã–∫–∞–ª—å–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ', '–ü–µ—Ä—Ñ–æ—Ä–º–∞–Ω—Å']
            },
            'education': {
                'name': 'Knowledge Hub {}',
                'description': '–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ {}. –£—á–∏–º—Å—è –Ω–æ–≤–æ–º—É, –¥–µ–ª–∏–º—Å—è –∑–Ω–∞–Ω–∏—è–º–∏ –∏ –ø–æ–º–æ–≥–∞–µ–º –¥—Ä—É–≥ –¥—Ä—É–≥—É —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è.',
                'keywords': ['–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', '–æ–±—É—á–µ–Ω–∏–µ', '—Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ', '–∫—É—Ä—Å—ã', '–∑–Ω–∞–Ω–∏—è', '—à–∫–æ–ª–∞'],
                'target_audience': '–°—Ç—É–¥–µ–Ω—Ç—ã, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏, —ç–∫—Å–ø–µ—Ä—Ç—ã, –≤—Å–µ –∫—Ç–æ —É—á–∏—Ç—Å—è –∏ —É—á–∏—Ç',
                'activities': '–õ–µ–∫—Ü–∏–∏ –∏ —Å–µ–º–∏–Ω–∞—Ä—ã, —É—á–µ–±–Ω—ã–µ –≥—Ä—É–ø–ø—ã, —è–∑—ã–∫–æ–≤—ã–µ –∫–ª—É–±—ã, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º',
                'skills': ['–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ —è–∑—ã–∫–∏', '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', '–ù–∞—É—á–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è', '–ü—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏–µ']
            },
            'sports': {
                'name': 'SportTeam {}',
                'description': '–°–ø–æ—Ä—Ç–∏–≤–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ {}. –ó–∞–Ω–∏–º–∞–µ–º—Å—è —Å–ø–æ—Ä—Ç–æ–º –≤–º–µ—Å—Ç–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∏ –¥–æ—Å—Ç–∏–≥–∞–µ–º –Ω–æ–≤—ã—Ö —Ü–µ–ª–µ–π.',
                'keywords': ['—Å–ø–æ—Ä—Ç', '—Ñ–∏—Ç–Ω–µ—Å', '–∑–¥–æ—Ä–æ–≤—å–µ', '—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏', '–∞–∫—Ç–∏–≤–Ω—ã–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏'],
                'target_audience': '–°–ø–æ—Ä—Ç—Å–º–µ–Ω—ã, –ª—é–±–∏—Ç–µ–ª–∏ —Ñ–∏—Ç–Ω–µ—Å–∞, –≤—Å–µ –∫—Ç–æ –∑–∞–±–æ—Ç–∏—Ç—Å—è –æ –∑–¥–æ—Ä–æ–≤—å–µ',
                'activities': '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è, –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è',
                'skills': ['–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞', '–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å', '–ó–¥–æ—Ä–æ–≤—å–µ', '–°–∏–ª–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è']
            },
            'social': {
                'name': 'Community Circle {}',
                'description': '–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ {}. –í–º–µ—Å—Ç–µ –¥–µ–ª–∞–µ–º –¥–æ–±—Ä—ã–µ –¥–µ–ª–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∏ —Å–æ–∑–¥–∞–µ–º –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.',
                'keywords': ['—Å–æ—Ü–∏–∞–ª—å–Ω—ã–π', '–≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ', '–±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–ø–æ–º–æ—â—å', '–æ–±—â–µ–Ω–∏–µ'],
                'target_audience': '–ê–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞–∂–¥–∞–Ω–µ, –≤–æ–ª–æ–Ω—Ç–µ—Ä—ã, –Ω–µ—Ä–∞–≤–Ω–æ–¥—É—à–Ω—ã–µ –ª—é–¥–∏',
                'activities': '–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∞–∫—Ü–∏–∏, –≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ, —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω—É–∂–¥–∞—é—â–∏—Ö—Å—è',
                'skills': ['–≠–º–ø–∞—Ç–∏—è', '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è', '–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è', '–õ–∏–¥–µ—Ä—Å—Ç–≤–æ']
            },
            'hobby': {
                'name': 'Hobby Club {}',
                'description': '–ö–ª—É–± –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º {}. –û–±—ä–µ–¥–∏–Ω—è–µ–º –ª—é–¥–µ–π —Å–æ —Å—Ö–æ–∂–∏–º–∏ —É–≤–ª–µ—á–µ–Ω–∏—è–º–∏ –¥–ª—è –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è.',
                'keywords': ['—Ö–æ–±–±–∏', '—É–≤–ª–µ—á–µ–Ω–∏—è', '–æ—Ç–¥—ã—Ö', '–¥–æ—Å—É–≥', '–∏–Ω—Ç–µ—Ä–µ—Å—ã'],
                'target_audience': '–õ—é–¥–∏ —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Ö–æ–±–±–∏, –∏—â—É—â–∏–µ –µ–¥–∏–Ω–æ–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤',
                'activities': '–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—Å—Ç—Ä–µ—á–∏, –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã, —Ö–æ–±–±–∏-–≤—Å—Ç—Ä–µ—á–∏, —Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ –≤—ã–ª–∞–∑–∫–∏',
                'skills': ['–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å', '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', '–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π']
            }
        }

    def _get_name_generators(self) -> Dict[str, str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –Ω–∞–∑–≤–∞–Ω–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π"""
        return {
            'technology': ['Tech', 'Digital', 'Code', 'Dev', 'IT', 'Geek', 'Nerd'],
            'business': ['Business', 'Startup', 'Entrepreneur', 'Success', 'Growth', 'Connect'],
            'creative': ['Creative', 'Art', 'Design', 'Studio', 'Space', 'Hub', 'Vision'],
            'education': ['Knowledge', 'Learning', 'Academy', 'School', 'Edu', 'Study', 'Brain'],
            'sports': ['Sport', 'Fit', 'Active', 'Team', 'Power', 'Energy', 'Pro'],
            'social': ['Community', 'Social', 'Connect', 'Together', 'Circle', 'Unity', 'Good'],
            'hobby': ['Hobby', 'Club', 'Fun', 'Relax', 'Chill', 'Meet', 'Enjoy']
        }

    def _get_description_templates(self) -> Dict[str, str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —à–∞–±–ª–æ–Ω—ã –æ–ø–∏—Å–∞–Ω–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ü–µ–ª–µ–π"""
        return {
            'professional': '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è {} –≤ {}. –ú—ã —Å–æ–∑–¥–∞–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –æ–±–º–µ–Ω–∞ –æ–ø—ã—Ç–æ–º, –∫–∞—Ä—å–µ—Ä–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞ –∏ –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥–∞.',
            'learning': '–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è {} –≤ {}. –£—á–∏–º—Å—è –≤–º–µ—Å—Ç–µ, –¥–µ–ª–∏–º—Å—è –∑–Ω–∞–Ω–∏—è–º–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –¥—Ä—É–≥ –¥—Ä—É–≥–∞.',
            'social': '–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è {}. –í–º–µ—Å—Ç–µ –¥–µ–ª–∞–µ–º –º–∏—Ä –ª—É—á—à–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –¥—Ä—É–≥ –¥—Ä—É–≥–∞.',
            'entertainment': '–†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è {} –≤ {}. –í–µ—Å–µ–ª–æ –ø—Ä–æ–≤–æ–¥–∏–º –≤—Ä–µ–º—è, –∑–Ω–∞–∫–æ–º–∏–º—Å—è –∏ –æ—Ç–¥—ã—Ö–∞–µ–º.',
            'creative': '–¢–≤–æ—Ä—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è {} –≤ {}. –°–æ–≤–º–µ—Å—Ç–Ω–æ —Å–æ–∑–¥–∞–µ–º, –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ–º –∏ –¥–µ–ª–∏–º—Å—è –∫—Ä–∞—Å–æ—Ç–æ–π.',
            'health': '–°–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è {} –≤ {}. –ó–∞–±–æ—Ç–∏–º—Å—è –æ –∑–¥–æ—Ä–æ–≤—å–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –º–æ—Ç–∏–≤–∞—Ü–∏—é –∏ –¥–æ—Å—Ç–∏–≥–∞–µ–º —Ü–µ–ª–µ–π –≤–º–µ—Å—Ç–µ.'
        }

    def generate_club_ideas(self, user_interests: str, user_goals: str = '') -> List[Dict]:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–¥–µ–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        """
        ideas = []
        text_to_analyze = f"{user_interests} {user_goals}".lower()

        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        detected_categories = self._detect_interest_categories(text_to_analyze)

        for category in detected_categories:
            template = self.club_templates.get(category)
            if template:
                name_words = self.name_generators.get(category, ['Club'])
                name_word = name_words[0] if name_words else 'Club'

                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–∞–∑–≤–∞–Ω–∏–π
                for i, word in enumerate(name_words[:3]):
                    idea = {
                        'category': category,
                        'name': template['name'].format(word),
                        'description': template['description'],
                        'keywords': template['keywords'],
                        'target_audience': template['target_audience'],
                        'activities': template['activities'],
                        'skills': template['skills'],
                        'uniqueness': f'–£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ñ–æ–∫—É—Å –Ω–∞ {template["keywords"][0]} –∏ {" ".join(template["keywords"][:3])}',
                        'estimated_participants': '10-50',
                        'estimated_time_commitment': '2-4 —á–∞—Å–∞ –≤ –º–µ—Å—è—Ü',
                        'monetization_potential': '–°—Ä–µ–¥–Ω—è—è'
                    }
                    ideas.append(idea)

        return ideas

    def _detect_interest_categories(self, text: str) -> List[str]:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–∞
        """
        detected = []
        categories_keywords = {
            'technology': ['–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', 'it', '–∫–æ–¥', '–∫–æ–º–ø—å—é—Ç–µ—Ä', '—Ü–∏—Ñ—Ä–æ–≤–æ–π', '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞', 'software'],
            'business': ['–±–∏–∑–Ω–µ—Å', '–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ', '—Å—Ç–∞—Ä—Ç–∞–ø', '–∫–æ–º–ø–∞–Ω–∏—è', '–¥–µ–Ω—å–≥–∏', '–º–∞—Ä–∫–µ—Ç–∏–Ω–≥', '–ø—Ä–æ–¥–∞–∂–∏'],
            'creative': ['—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ', '–∏—Å–∫—É—Å—Å—Ç–≤–æ', '–¥–∏–∑–∞–π–Ω', '—Ä–∏—Å–æ–≤–∞–Ω–∏–µ', '—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è', '–º—É–∑—ã–∫–∞', '—Ç–∞–Ω—Ü—ã'],
            'education': ['—É—á–∏—Ç—å—Å—è', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', '–∫—É—Ä—Å—ã', '–∫–Ω–∏–≥–∏', '—à–∫–æ–ª–∞', '–∑–Ω–∞–Ω–∏—è', '–æ–±—É—á–µ–Ω–∏–µ'],
            'sports': ['—Å–ø–æ—Ä—Ç', '—Ñ–∏—Ç–Ω–µ—Å', '—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏', '–∑–¥–æ—Ä–æ–≤—å–µ', '–∞–∫—Ç–∏–≤–Ω—ã–π', '–±–µ–≥', '–π–æ–≥–∞'],
            'social': ['–æ–±—â–µ–Ω–∏–µ', '–ª—é–¥–∏', '–æ–±—â–µ—Å—Ç–≤–æ', '–ø–æ–º–æ—â—å', '–≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ', '—Å–æ—Ü–∏–∞–ª—å–Ω—ã–π'],
            'hobby': ['—Ö–æ–±–±–∏', '—É–≤–ª–µ—á–µ–Ω–∏—è', '–æ—Ç–¥—ã—Ö', '–¥–æ—Å—É–≥', '–∏–Ω—Ç–µ—Ä–µ—Å—ã', '—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è']
        }

        for category, keywords in categories_keywords.items():
            if any(keyword in text for keyword in keywords):
                detected.append(category)
                break

        return detected

    def generate_club_name_suggestions(self, category: str, custom_word: str = '') -> List[str]:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π –¥–ª—è –∫–ª—É–±–∞
        """
        suggestions = []

        template = self.club_templates.get(category)
        if template:
            name_words = self.name_generators.get(category, ['Club'])

            if custom_word:
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª–æ–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                suggestions.append(f"{custom_word} {template['name'].format('')}")

            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
            for word in name_words[:3]:
                suggestions.append(template['name'].format(word))

            # –î–æ–±–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º
            locations = ['–ê—Å—Ç–∞–Ω–∞', '–ê–ª–º–∞—Ç—ã', '–®—ã–º–∫–µ–Ω—Ç', '–ê–∫—Ç–æ–±–µ', '–ö–∞—Ä–∞–≥–∞–Ω–¥–∞']
            for location in locations[:2]:
                suggestions.append(f"{template['name'].format('')} {location}")

        return suggestions

    def create_club_description(self, category: str, custom_name: str = '', target_audience: str = '', activities: str = '', unique_aspect: str = '') -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∫–ª—É–±–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        """
        template = self.club_templates.get(category, {})

        if custom_name:
            base_desc = f"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ {custom_name}!"
        else:
            base_desc = template.get('description', '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ!')

        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏
        if target_audience:
            base_desc += f"\n\n**–î–ª—è –∫–æ–≥–æ:** {target_audience}"

        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö
        if activities:
            base_desc += f"\n\n**–ß–µ–º –∑–∞–Ω–∏–º–∞–µ–º—Å—è:** {activities}"

        # –î–æ–±–∞–≤–ª—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
        if unique_aspect:
            base_desc += f"\n\n**–ù–∞—à–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:** {unique_aspect}"

        # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é
        base_desc += f"\n\n–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞–º, —á—Ç–æ–±—ã {template.get('keywords', ['—É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å', '—Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è', '–æ–±—â–∞—Ç—å—Å—è'])} –≤–º–µ—Å—Ç–µ!"

        return base_desc

    def generate_monetization_ideas(self, category: str) -> List[Dict]:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–¥–µ–∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∫–ª—É–±–∞
        """
        ideas = []

        if category == 'education':
            ideas.extend([
                {
                    'method': '–ü–ª–∞—Ç–Ω—ã–µ –∫—É—Ä—Å—ã',
                    'description': '–°–æ–∑–¥–∞–π—Ç–µ –∏ –ø—Ä–æ–¥–∞–≤–∞–π—Ç–µ –æ–Ω–ª–∞–π–Ω –∫—É—Ä—Å—ã –ø–æ –≤–∞—à–µ–π —Ç–µ–º–µ',
                    'estimated_income': '50 000 - 200 000 —Ç–≥/–º–µ—Å—è—Ü',
                    'difficulty': '–°—Ä–µ–¥–Ω—è—è'
                },
                {
                    'method': '–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏',
                    'description': '–ü—Ä–µ–¥–ª–∞–≥–∞–π—Ç–µ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏ –º–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ',
                    'estimated_income': '10 000 - 50 000 —Ç–≥/–º–µ—Å—è—Ü',
                    'difficulty': '–ù–∏–∑–∫–∞—è'
                }
            ])
        elif category == 'technology':
            ideas.extend([
                {
                    'method': '–í–µ–±–∏–Ω–∞—Ä—ã –∏ –≤–æ—Ä–∫—à–æ–ø—ã',
                    'description': '–ü—Ä–æ–≤–æ–¥–∏—Ç–µ –ø–ª–∞—Ç–Ω—ã–µ –æ–±—É—á–∞—é—â–∏–µ –≤–µ–±–∏–Ω–∞—Ä—ã –ø–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º',
                    'estimated_income': '30 000 - 150 000 —Ç–≥/–º–µ—Å—è—Ü',
                    'difficulty': '–°—Ä–µ–¥–Ω—è—è'
                },
                {
                    'method': 'IT-–∫–æ–Ω—Å–∞–ª—Ç–∞—Ü–∏–∏',
                    'description': '–û–∫–∞–∑—ã–≤–∞–π—Ç–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏ –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π',
                    'estimated_income': '100 000 - 500 000 —Ç–≥/–º–µ—Å—è—Ü',
                    'difficulty': '–í—ã—Å–æ–∫–∞—è'
                }
            ])
        elif category == 'creative':
            ideas.extend([
                {
                    'method': '–ü—Ä–æ–¥–∞–∂–∞ —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç',
                    'description': '–ü—Ä–æ–¥–∞–≤–∞–π—Ç–µ —Ä–∞–±–æ—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ –æ–Ω–ª–∞–π–Ω-–≥–∞–ª–µ—Ä–µ—é',
                    'estimated_income': '20 000 - 100 000 —Ç–≥/–º–µ—Å—è—Ü',
                    'difficulty': '–ù–∏–∑–∫–∞—è'
                },
                {
                    'method': '–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã',
                    'description': '–ü—Ä–æ–≤–æ–¥–∏—Ç–µ –ø–ª–∞—Ç–Ω—ã–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã –ø–æ –≤–∞—à–µ–º—É —Ç–≤–æ—Ä—á–µ—Å–∫–æ–º—É –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é',
                    'estimated_income': '15 000 - 75 000 —Ç–≥/–º–µ—Å—è—Ü',
                    'difficulty': '–°—Ä–µ–¥–Ω—è—è'
                }
            ])

        # –û–±—â–∏–µ –∏–¥–µ–∏ –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        ideas.extend([
            {
                'method': '–ü–ª–∞—Ç–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏',
                'description': '–û—Ä–≥–∞–Ω–∏–∑—É–π—Ç–µ –ø–ª–∞—Ç–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏ –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è',
                'estimated_income': '5 000 - 25 000 —Ç–≥/–º–µ—Å—è—Ü',
                'difficulty': '–ù–∏–∑–∫–∞—è'
            },
            {
                'method': '–ß–ª–µ–Ω—Å–∫–∏–µ –≤–∑–Ω–æ—Å—ã',
                'description': '–°–æ–∑–¥–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –ø–ª–∞—Ç–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫',
                'estimated_income': '10 000 - 50 000 —Ç–≥/–º–µ—Å—è—Ü',
                'difficulty': '–°—Ä–µ–¥–Ω—è—è'
            },
            {
                'method': '–ë—Ä–µ–Ω–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è',
                'description': '–°–æ–∑–¥–∞–π—Ç–µ –∏ –ø—Ä–æ–¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–¥—É–∫—Ü–∏—é —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º –∫–ª—É–±–∞',
                'estimated_income': '20 000 - 100 000 —Ç–≥/–º–µ—Å—è—Ü',
                'difficulty': '–°—Ä–µ–¥–Ω—è—è'
            }
        ])

        return ideas

    def generate_roadmap(self, category: str) -> Dict:
        """
        –°–æ–∑–¥–∞–µ—Ç –¥–æ—Ä–æ–∂–∫—É —Ä–∞–∑–≤–∏—Ç–∏—è –¥–ª—è –∫–ª—É–±–∞
        """
        roadmap = {
            'phase_1': {
                'name': '–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —è–¥—Ä–∞',
                'duration': '1-2 –º–µ—Å—è—Ü–∞',
                'goals': ['–°–æ–±—Ä–∞—Ç—å 10-20 –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤', '–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞', '–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω'],
                'activities': ['–ü—Ä–æ–≤–µ—Å—Ç–∏ 2-3 –≤—Å—Ç—Ä–µ—á–∏', '–°–æ–∑–¥–∞—Ç—å —á–∞—Ç –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ', '–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ—Ü—Å–µ—Ç–∏']
            },
            'phase_2': {
                'name': '–†–æ—Å—Ç –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ',
                'duration': '3-6 –º–µ—Å—è—Ü–µ–≤',
                'goals': ['–î–æ—Å—Ç–∏—á—å 50+ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤', '–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤–æ–µ –ø–ª–∞—Ç–Ω–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ', '–°–æ–∑–¥–∞—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–∞'],
                'activities': ['–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏', '–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –æ—Ç —ç–∫—Å–ø–µ—Ä—Ç–∞', '–ó–∞–ø—É—Å—Ç–∏—Ç—å —á–∞—Ç-–±–æ—Ç']
            },
            'phase_3': {
                'name': '–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞',
                'duration': '6-12 –º–µ—Å—è—Ü–µ–≤',
                'goals': ['–°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã', '–ù–∞—á–∞—Ç—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—é', '–†–∞—Å—à–∏—Ä–∏—Ç—å –≥–µ–æ–≥—Ä–∞—Ñ–∏—é'],
                'activities': ['–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∫—É—Ä—Å—ã', '–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ç—Ä–µ–Ω–∏–Ω–≥–∏', '–ì–æ–¥–æ–≤–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ']
            },
            'phase_4': {
                'name': '–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ',
                'duration': '1+ –≥–æ–¥–∞',
                'goals': ['–û—Ç–∫—Ä—ã—Ç—å —Ñ–∏–ª–∏–∞–ª—ã', '–°–æ–∑–¥–∞—Ç—å –æ–Ω–ª–∞–π–Ω-—à–∫–æ–ª—É', '–ü–æ–ª—É—á–∏—Ç—å —Å–ø–æ–Ω—Å–æ—Ä—Å—Ç–≤–æ'],
                'activities': ['–ó–∞–ø—É—Å–∫ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è', '–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ', '–ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–Ω–∏–≥–∏']
            }
        }

        return roadmap

    def create_action_plan(self, user_idea: str, user_experience: str = '', user_resources: str = '') -> Dict:
        """
        –°–æ–∑–¥–∞–µ—Ç –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞
        """
        plan = {
            'preparation': {
                'title': '–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø (1-2 –Ω–µ–¥–µ–ª–∏)',
                'steps': [
                    '–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –∏ –º–∏—Å—Å–∏—é –∫–ª—É–±–∞',
                    '–í—ã–±—Ä–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ',
                    '–ù–∞–ø–∏—Å–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ',
                    '–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø',
                    '–°–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –Ω–∞ 3 –º–µ—Å—è—Ü–∞'
                ],
                'estimated_time': '10-20 —á–∞—Å–æ–≤'
            },
            'technical': {
                'title': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (1 –Ω–µ–¥–µ–ª—è)',
                'steps': [
                    '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –¶–ï–ù–¢–† –°–û–ë–´–¢–ò–ô',
                    '–°–æ–∑–¥–∞—Ç—å –∫–ª—É–± —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –Ω–∞ —Å–∞–π—Ç–µ',
                    '–ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –ø–æ–ª—è',
                    '–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö',
                    '–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –ø—É–±–ª–∏–∫–∞—Ü–∏—é'
                ],
                'estimated_time': '5-10 —á–∞—Å–æ–≤'
            },
            'launch': {
                'title': '–ó–∞–ø—É—Å–∫ –∏ –ø–µ—Ä–≤–æ–µ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ (2-4 –Ω–µ–¥–µ–ª–∏)',
                'steps': [
                    '–†–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ –∫–ª—É–±–µ –≤ —Å–≤–æ–∏—Ö —Å–æ—Ü—Å–µ—Ç—è—Ö',
                    '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å 10-15 –ø–µ—Ä–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤',
                    '–ü—Ä–æ–≤–µ—Å—Ç–∏ —É—á—Ä–µ–¥–∏—Ç–µ–ª—å–Ω—É—é –≤—Å—Ç—Ä–µ—á—É',
                    '–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω –Ω–∞ –º–µ—Å—è—Ü',
                    '–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏'
                ],
                'estimated_time': '10-20 —á–∞—Å–æ–≤'
            },
            'growth': {
                'title': '–†–æ—Å—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ (2-6 –º–µ—Å—è—Ü–µ–≤)',
                'steps': [
                    '–ü—Ä–æ–≤–æ–¥–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è',
                    '–°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã',
                    '–ü—Ä–∏–≤–ª–µ–∫–∞—Ç—å –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤',
                    '–ù–∞—á–∞—Ç—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—é',
                    '–ò–∑–º–µ—Ä—è—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã'
                ],
                'estimated_time': '15-30 —á–∞—Å–æ–≤ –≤ –º–µ—Å—è—Ü'
            }
        }

        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ—Å—É—Ä—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –¥–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã
        if user_resources:
            if '–≤—Ä–µ–º—è' in user_resources.lower():
                plan['preparation']['estimated_time'] = '20-30 —á–∞—Å–æ–≤'
                plan['growth']['estimated_time'] = '20-40 —á–∞—Å–æ–≤ –≤ –º–µ—Å—è—Ü'

            if '–¥–µ–Ω—å–≥–∏' in user_resources.lower() or '–±—é–¥–∂–µ—Ç' in user_resources.lower():
                plan['technical']['steps'].append('–ë—é–¥–∂–µ—Ç –Ω–∞ —Ä–µ–∫–ª–∞–º—É –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è')
                plan['launch']['steps'].append('–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–ª–∞—Ç–Ω—É—é —Ä–µ–∫–ª–∞–º—É')
                plan['growth']['steps'].append('–°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–º–∏—É–º-–∫–æ–Ω—Ç–µ–Ω—Ç')

        if user_experience:
            if '–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å' in user_experience.lower() or '–±–∏–∑–Ω–µ—Å' in user_experience.lower():
                plan['preparation']['steps'].append('–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å')
                plan['growth']['steps'].append('–°–æ–∑–¥–∞—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–∞ —Å –∫–æ–º–ø–∞–Ω–∏—è–º–∏')
                plan['launch']['steps'].append('–°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤')

        return plan

    def get_guidance(self, message: str) -> str:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∫–ª—É–±–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        """
        message_lower = message.lower()

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–¥–µ–∏ –¥–ª—è –∫–ª—É–±–æ–≤
        if any(word in message_lower for word in ['–∏–¥–µ—è', '–ø–æ–¥—É–º–∞—Ç—å', '–ø—Ä–∏–¥—É–º–∞—Ç—å', '–∫–æ–Ω—Ü–µ–ø—Ü–∏—è']):
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–¥–µ–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
            ideas = self.generate_club_ideas(message, "")

            if ideas:
                response = "üí° **–ò–¥–µ–∏ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞:**\n\n"
                for i, idea in enumerate(ideas[:3], 1):
                    response += f"**{i}. {idea['name']}**\n"
                    response += f"üìù {idea['description']}\n"
                    response += f"üë• **–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è:** {idea['target_audience']}\n"
                    response += f"üéØ **–ß–µ–º –∑–∞–Ω–∏–º–∞—Ç—å—Å—è:** {idea['activities']}\n"
                    response += f"üí∞ **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏:** {idea['monetization_potential']}\n\n"

                response += "–ö–∞–∫–∞—è –∏–¥–µ—è –≤–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è? –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ, –∏ —è –ø–æ–º–æ–≥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞–Ω!"
            else:
                response = self._get_general_club_creation_guide()

        elif any(word in message_lower for word in ['–Ω–∞–∑–≤–∞–Ω–∏–µ', '–Ω–∞–∑–≤–∞—Ç—å', '–∏–º—è']):
            # –ü–æ–º–æ—â—å —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º
            response = "üéØ **–ü—Ä–∏–¥—É–º—ã–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –∫–ª—É–±–∞:**\n\n"
            response += "**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —Ö–æ—Ä–æ—à–µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è:**\n"
            response += "‚Ä¢ –õ–µ–≥–∫–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å –∏ –ø—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏\n"
            response += "‚Ä¢ –û—Ç—Ä–∞–∂–∞–µ—Ç —Å—É—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–∞\n"
            response += "‚Ä¢ –í—ã–¥–µ–ª—è–µ—Ç—Å—è —Å—Ä–µ–¥–∏ –¥—Ä—É–≥–∏—Ö\n"
            response += "‚Ä¢ –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏\n\n"
            response += "**–ü—Ä–∏–º–µ—Ä—ã —É–¥–∞—á–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π:**\n"
            response += "‚Ä¢ TechHub –ê—Å—Ç–∞–Ω–∞\n"
            response += "‚Ä¢ Creative Space\n"
            response += "‚Ä¢ Business Connect\n"
            response += "‚Ä¢ SportTeam\n\n"
            response += "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–π –∏–¥–µ–µ, –∏ —è –ø—Ä–µ–¥–ª–æ–∂—É –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π!"

        elif any(word in message_lower for word in ['–º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è', '–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å', '–¥–µ–Ω—å–≥–∏', '–±–∏–∑–Ω–µ—Å']):
            # –ò–¥–µ–∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏
            response = "üí∞ **–°–ø–æ—Å–æ–±—ã –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞:**\n\n"

            monetization_ideas = self.generate_monetization_ideas('general')

            for idea in monetization_ideas[:5]:
                response += f"**üíº {idea['method']}**\n"
                response += f"{idea['description']}\n"
                response += f"üíµ –î–æ—Ö–æ–¥: {idea['estimated_income']}\n"
                response += f"üìà –°–ª–æ–∂–Ω–æ—Å—Ç—å: {idea['difficulty']}\n\n"

            response += "**üéØ –°–æ–≤–µ—Ç—ã:**\n"
            response += "‚Ä¢ –ù–∞—á–Ω–∏—Ç–µ —Å –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏\n"
            response += "‚Ä¢ –°–æ–∑–¥–∞–π—Ç–µ —Ü–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø–µ—Ä–µ–¥ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π\n"
            response += "‚Ä¢ –ü—Ä–µ–¥–ª–∞–≥–∞–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —É—á–∞—Å—Ç–∏—è\n"
            response += "‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ –∫—É—Ä—Å–æ–≤ –∏ —Ç–æ–≤–∞—Ä–æ–≤\n\n"
            response += "–•–æ—Ç–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ –∫–∞–∫–æ–º-—Ç–æ —Å–ø–æ—Å–æ–±–µ?"

        elif any(word in message_lower for word in ['–ø–ª–∞–Ω', '—à–∞–≥–∏', '–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è', '–∞–ª–≥–æ—Ä–∏—Ç–º']):
            # –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω
            response_plan = self.create_action_plan(message)

            formatted_response = "üìã **–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞:**\n\n"

            for phase_key, phase_data in response_plan.items():
                formatted_response += f"**{phase_data['title']}**\n"
                formatted_response += f"‚è±Ô∏è –í—Ä–µ–º—è: {phase_data['estimated_time']}\n\n"

                for step in phase_data['steps']:
                    formatted_response += f"‚úÖ {step}\n"
                formatted_response += "\n"

            formatted_response += "**üí° –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**\n"
            formatted_response += "1. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –º–Ω–µ –æ –≤–∞—à–µ–π –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏\n"
            formatted_response += "2. –Ø –ø–æ–º–æ–≥—É —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º\n"
            formatted_response += "3. –†–∞–∑—Ä–∞–±–æ—Ç–∞–µ–º –ø–ª–∞–Ω –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π\n"
            formatted_response += "4. –û–±—Å—É–¥–∏–º —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤\n\n"
            formatted_response += "–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å —Å –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞?"
            
            response = formatted_response

        else:
            # –û–±—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é
            response = self._get_general_club_creation_guide()

        return response

    def _get_general_club_creation_guide(self) -> str:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∫–ª—É–±–∞
        """
        return """üöÄ **–°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –Ω–∞ –¶–ï–ù–¢–† –°–û–ë–´–¢–ò–ô!**

–Ø –ø–æ–º–æ–≥—É –≤–∞–º —Å–æ–∑–¥–∞—Ç—å —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ —Å –Ω—É–ª—è!

**üìã –≠—Ç–∞–ø—ã —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞:**

**1Ô∏è‚É£ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –∏–¥–µ—è (1-2 –¥–Ω—è)**
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
- –í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é
- –ü—Ä–æ–¥—É–º–∞–π—Ç–µ —Ü–µ–Ω–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –≤—ã –¥–∞–µ—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º

**2Ô∏è‚É£ –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –±—Ä–µ–Ω–¥–∏–Ω–≥ (1 –¥–µ–Ω—å)**
- –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –∑–∞–ø–æ–º–∏–Ω–∞—é—â–µ–µ—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ
- –°–æ–∑–¥–∞–π—Ç–µ –ª–æ–≥–æ—Ç–∏–ø (500x500px)
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å—Ç–∏–ª—å —Å–æ–æ–±—â–µ—Å—Ç–≤–∞

**3Ô∏è‚É£ –û–ø–∏—Å–∞–Ω–∏–µ –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (2-3 —á–∞—Å–∞)**
- –ù–∞–ø–∏—à–∏—Ç–µ —á–µ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–æ—Ç 200 —Å–∏–º–≤–æ–ª–æ–≤)
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞
- –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ —É—á–∞—Å—Ç–∏—è

**4Ô∏è‚É£ –ü–ª–∞–Ω –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π (1-2 –¥–Ω—è)**
- –ü—Ä–æ–¥—É–º–∞–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ó–∞–ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –≤—Å—Ç—Ä–µ—á (–æ—Ñ–ª–∞–π–Ω/–æ–Ω–ª–∞–π–Ω)

**5Ô∏è‚É£ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (30 –º–∏–Ω—É—Ç)**
- –°–æ–∑–¥–∞–π—Ç–µ –∫–ª—É–± —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
- –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö

**üí∞ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏:**
- –ü—Ä–æ–¥–∞–∂–∞ –∫—É—Ä—Å–æ–≤ –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º
- –¢–æ–≤–∞—Ä—ã —Å —Å–∏–º–≤–æ–ª–∏–∫–æ–π –∫–ª—É–±–∞
- –ü–ª–∞—Ç–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã
- –ß–ª–µ–Ω—Å–∫–∏–µ –≤–∑–Ω–æ—Å—ã
- –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏

**üéØ –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –º–Ω–µ –æ –≤–∞—à–µ–π –∏–¥–µ–µ:**
1. –ö–∞–∫—É—é —Ç–µ–º—É –∏–ª–∏ —Ö–æ–±–±–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Ä–∞–∑–≤–∏–≤–∞—Ç—å?
2. –ö—Ç–æ –≤–∞—à–∞ —Ü–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è?
3. –ö–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É –≤—ã —Ä–µ—à–∞–µ—Ç–µ –∏–ª–∏ —Ü–µ–Ω–Ω–æ—Å—Ç—å –¥–∞–µ—Ç–µ?

–Ø –ø–æ–º–æ–≥—É –≤–∞–º —Å –∫–∞–∂–¥—ã–º —à–∞–≥–æ–º! üåü"""

    def create_club(self, user, name: str, description: str, category_name: str, city_name: str = None, is_private: bool = False) -> Dict:
        """
        –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∫–ª—É–± –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
        """
        from .club_validator import ClubCreationValidator
        
        try:
            # 1. Comprehensive Validation
            is_valid, errors = ClubCreationValidator.validate_all(
                user, name, description, category_name
            )
            
            if not is_valid:
                return {
                    'success': False,
                    'error': '\n'.join(errors),
                    'validation_errors': errors
                }
            
            # 2. Get suggestions for improvements
            suggestions = ClubCreationValidator.suggest_improvements(name, description)
            
            # 3. Get or Create Category
            category = None
            if category_name:
                # Try exact match first
                category = ClubCategory.objects.filter(name__iexact=category_name).first()
                # Try partial match
                if not category:
                    category = ClubCategory.objects.filter(name__icontains=category_name).first()
            
            if not category:
                # Try to find by keywords
                category_mapping = {
                    '—Å–ø–æ—Ä—Ç': '–°–ø–æ—Ä—Ç',
                    '—Ö–æ–±–±–∏': '–•–æ–±–±–∏',
                    'it': 'IT',
                    '–ø—Ä–æ—Ñ–µ—Å—Å–∏—è': '–ü—Ä–æ—Ñ–µ—Å—Å–∏—è',
                    '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ': '–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ',
                    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ',
                    '–±–∏–∑–Ω–µ—Å': '–ë–∏–∑–Ω–µ—Å'
                }
                
                category_lower = category_name.lower()
                for keyword, cat_name in category_mapping.items():
                    if keyword in category_lower:
                        category = ClubCategory.objects.filter(name__icontains=cat_name).first()
                        if category:
                            break
            
            if not category:
                # Default to '–•–æ–±–±–∏' or first available
                category = ClubCategory.objects.filter(name__icontains='–•–æ–±–±–∏').first() or ClubCategory.objects.first()
                
            if not category:
                return {
                    'success': False,
                    'error': '–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–ª—É–±–æ–≤. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.'
                }

            # 4. Get City (Optional)
            city = None
            if city_name:
                city = City.objects.filter(name__icontains=city_name).first()
                if not city:
                    # Try to create city if it doesn't exist (optional)
                    # For now, just log a warning
                    import logging
                    logger = logging.getLogger(__name__)
                    logger.warning(f"City '{city_name}' not found in database")

            # 5. Check for duplicate club names
            existing_club = Club.objects.filter(name__iexact=name).first()
            if existing_club:
                return {
                    'success': False,
                    'error': f'‚ùå –ö–ª—É–± —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º "{name}" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ.',
                    'duplicate': True
                }

            # 6. Create Club
            club = Club.objects.create(
                name=name.strip(),
                category=category,
                creater=user,
                description=description.strip(),
                city=city,
                is_private=is_private,
                email=user.email,
                phone=getattr(user, 'phone', '+77000000000'),  # Fallback phone
                address='Online' if not city else f"{city.name}, Center"
            )
            
            # 7. Add creator to members and managers
            club.members.add(user)
            club.managers.add(user)
            
            # 8. Return success with suggestions
            return {
                'success': True,
                'club_id': str(club.id),
                'club_name': club.name,
                'link': f"/clubs/{club.id}/",
                'suggestions': suggestions,
                'category_used': category.name
            }

        except Exception as e:
            import logging
            logger = logging.getLogger(__name__)
            logger.error(f"Error creating club: {e}", exc_info=True)
            
            # Provide user-friendly error messages
            error_message = str(e)
            if 'UNIQUE constraint failed' in error_message:
                return {
                    'success': False,
                    'error': '‚ùå –ö–ª—É–± —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ.'
                }
            elif 'NOT NULL constraint failed' in error_message:
                return {
                    'success': False,
                    'error': '‚ùå –ù–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é.'
                }
            else:
                return {
                    'success': False,
                    'error': f'‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª—É–±–∞: {error_message}'
                }