#\!/bin/bash
# üöÄ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç UnitySphere AI –≤–∏–¥–∂–µ—Ç–∞

echo "üß™ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç AI –≤–∏–¥–∂–µ—Ç–∞ UnitySphere"
echo "========================================="

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Django
if curl -s http://127.0.0.1:8000/ > /dev/null; then
    echo "‚úÖ Django —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 8000"
else
    echo "‚ùå Django —Å–∞–π—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º AI –∞–≥–µ–Ω—Ç
if curl -s http://127.0.0.1:8001/api/v1/ai/production/health/ > /dev/null; then
    echo "‚úÖ AI –∞–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 8001"
else
    echo "‚ùå AI –∞–≥–µ–Ω—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º AI –ø—Ä–æ–∫—Å–∏
if curl -s http://127.0.0.1:8000/api/v1/ai/production/health/ | grep -q "healthy"; then
    echo "‚úÖ AI –ø—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"
else
    echo "‚ùå AI –ø—Ä–æ–∫—Å–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤–∏–¥–∂–µ—Ç–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
if curl -s http://127.0.0.1:8000/ | grep -q "guaranteed-widget-button"; then
    echo "‚úÖ AI –≤–∏–¥–∂–µ—Ç –Ω–∞–π–¥–µ–Ω –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"
else
    echo "‚ùå AI –≤–∏–¥–∂–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"
    exit 1
fi

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–∏–¥–∂–µ—Ç
echo ""
echo "üí¨ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–∏–¥–∂–µ—Ç..."

response=$(curl -s -X POST http://127.0.0.1:8000/api/v1/ai/production/agent/ \
  -H "Content-Type: application/json" \
  -d '{"message":"–¢–µ—Å—Ç –≤–∏–¥–∂–µ—Ç–∞","session_id":"widget_test"}')

if echo "$response" | grep -q '"success": true'; then
    echo "‚úÖ –í–∏–¥–∂–µ—Ç —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è"
    echo "ü§ñ –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: $(echo "$response" | grep -o '"response":"[^"]*"' | head -1 | cut -d'"' -f4 | cut -c1-50)..."
else
    echo "‚ùå –í–∏–¥–∂–µ—Ç –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è"
    echo "–û—à–∏–±–∫–∞: $response"
    exit 1
fi

echo ""
echo "üéâ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:"
echo "======================"
echo "‚úÖ Django —Å–∞–π—Ç: –†–ê–ë–û–¢–ê–ï–¢"
echo "‚úÖ AI –∞–≥–µ–Ω—Ç: –†–ê–ë–û–¢–ê–ï–¢"
echo "‚úÖ AI –ø—Ä–æ–∫—Å–∏: –†–ê–ë–û–¢–ê–ï–¢"
echo "‚úÖ AI –≤–∏–¥–∂–µ—Ç: –†–ê–ë–û–¢–ê–ï–¢"
echo "‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è: –û–¢–ü–†–ê–í–õ–Ø–Æ–¢–°–Ø"
echo ""
echo "üöÄ UnitySphere AI –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–¢–ê–ï–¢\!"
echo "üåê –°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω: http://127.0.0.1:8000/"
echo "ü§ñ AI –≤–∏–¥–∂–µ—Ç: –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ ü§ñ –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É"
echo ""
echo "üéä –ü–û–ó–†–ê–í–õ–Ø–Æ\! –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞\!"
